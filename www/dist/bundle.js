(()=>{"use strict";var t,e,i={},s={};function n(t){var e=s[t];if(void 0!==e)return e.exports;var o=s[t]={exports:{}};return i[t](o,o.exports,n),o.exports}n.m=i,n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((e,i)=>(n.f[i](t,e),e),[])),n.u=t=>t+".bundle.js",n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="neural-network-arena-frontend:",n.l=(i,s,o,a)=>{if(t[i])t[i].push(s);else{var r,h;if(void 0!==o)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==e+o){r=d;break}}r||(h=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,n.nc&&r.setAttribute("nonce",n.nc),r.setAttribute("data-webpack",e+o),r.src=i),t[i]=[s];var m=(e,s)=>{r.onerror=r.onload=null,clearTimeout(g);var n=t[i];if(delete t[i],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach(t=>t(s)),e)return e(s)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=m.bind(null,r.onerror),r.onload=m.bind(null,r.onload),h&&document.head.appendChild(r)}},n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var s=i.length-1;s>-1&&(!t||!/^http(s?):/.test(t));)t=i[s--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{n.b=document.baseURI||self.location.href;var t={792:0};n.f.j=(e,i)=>{var s=n.o(t,e)?t[e]:void 0;if(0!==s)if(s)i.push(s[2]);else{var o=new Promise((i,n)=>s=t[e]=[i,n]);i.push(s[2]=o);var a=n.p+n.u(e),r=new Error;n.l(a,i=>{if(n.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;r.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",r.name="ChunkLoadError",r.type=o,r.request=a,s[1](r)}},"chunk-"+e,e)}};var e=(e,i)=>{var s,o,[a,r,h]=i,l=0;if(a.some(e=>0!==t[e])){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);h&&h(n)}for(e&&e(i);l<a.length;l++)o=a[l],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0},i=self.webpackChunkneural_network_arena_frontend=self.webpackChunkneural_network_arena_frontend||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();class o{constructor(t){this.width=0,this.height=0,this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("Failed to get 2D rendering context");this.ctx=e;const i=window.devicePixelRatio||1,s=t.getBoundingClientRect();t.width=s.width*i,t.height=s.height*i,this.ctx.scale(i,i),t.style.width=s.width+"px",t.style.height=s.height+"px",this.width=s.width,this.height=s.height}resize(t,e){this.width=t,this.height=e;const i=window.devicePixelRatio||1;this.canvas.width=t*i,this.canvas.height=e*i,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.scale(i,i)}render(t,e){this.ctx.clearRect(0,0,this.width,this.height),this.ctx.fillStyle="#0a0a23",this.ctx.fillRect(0,0,this.width,this.height);const i=.8*Math.min(this.width/64,this.height/64),s=(this.width-64*i)/2,n=(this.height-64*i)/2;e.showTerritories&&this.renderTerritories(t.territories,i,s,n),e.showResources&&this.renderResources(t.resources,i,s,n),this.renderWarriors(t.warriors,i,s,n),this.renderOverlay(t)}renderTerritories(t,e,i,s){for(const n of t){const t=n.center_x*e+i,o=n.center_y*e+s,a=n.radius*e;this.ctx.beginPath(),this.ctx.arc(t,o,a,0,2*Math.PI),this.ctx.strokeStyle=n.owner_id?"#0088ff44":"#ffffff22",this.ctx.lineWidth=n.owner_id?2:1,this.ctx.stroke();const r=Math.min(.1*n.resource_multiplier,.3);this.ctx.fillStyle=`rgba(0, 255, 136, ${r})`,this.ctx.fill(),n.owner_id&&(this.ctx.fillStyle="#0088ff",this.ctx.beginPath(),this.ctx.arc(t,o,3,0,2*Math.PI),this.ctx.fill())}}renderResources(t,e,i,s){for(const n of t){const t=n.x*e+i,o=n.y*e+s,a=this.ctx.createRadialGradient(t,o,0,t,o,8);a.addColorStop(0,"#ffff00aa"),a.addColorStop(1,"#ffff0000"),this.ctx.fillStyle=a,this.ctx.beginPath(),this.ctx.arc(t,o,8,0,2*Math.PI),this.ctx.fill();const r=Math.max(2,Math.min(6,n.energy_value/10));this.ctx.fillStyle="#ffff00",this.ctx.beginPath(),this.ctx.arc(t,o,r,0,2*Math.PI),this.ctx.fill(),this.ctx.fillStyle="#ffffff",this.ctx.font="8px monospace",this.ctx.textAlign="center",this.ctx.fillText(n.resource_type.charAt(0).toUpperCase(),t,o-10)}}renderWarriors(t,e,i,s){const n=[...t].sort((t,e)=>t.fitness-e.fitness);for(const t of n){const n=t.x*e+i,o=t.y*e+s,a=Math.min(t.energy/100,1),r=3+4*a;let h;if(h=a>.7?"#00ff88":a>.4?"#0088ff":"#ff8800",t.fitness>50){const e=r+t.fitness/20,i=this.ctx.createRadialGradient(n,o,0,n,o,e);i.addColorStop(0,h+"66"),i.addColorStop(1,h+"00"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(n,o,e,0,2*Math.PI),this.ctx.fill()}if(this.ctx.fillStyle=h,this.ctx.beginPath(),this.ctx.arc(n,o,r,0,2*Math.PI),this.ctx.fill(),void 0!==t.species_id&&(this.ctx.strokeStyle=`hsl(${60*t.species_id%360}, 70%, 50%)`,this.ctx.lineWidth=1,this.ctx.stroke()),t.action&&"idle"!==t.action&&(this.ctx.fillStyle="#ffffff",this.ctx.font="10px monospace",this.ctx.textAlign="center",this.ctx.fillText(this.getActionSymbol(t.action),n,o-r-5)),t.lineage_depth>0){const e=Math.min(t.lineage_depth,5);for(let t=0;t<e;t++)this.ctx.fillStyle="#ffffff44",this.ctx.beginPath(),this.ctx.arc(n-r+2*t,o+r+3,.5,0,2*Math.PI),this.ctx.fill()}}}getActionSymbol(t){switch(t.toLowerCase()){case"move":return"‚Üí";case"attack":return"‚öî";case"defend":return"üõ°";case"collect":return"üíé";case"reproduce":return"üß¨";case"explore":return"üëÅ";default:return"‚Ä¢"}}renderOverlay(t){this.ctx.strokeStyle="#ffffff11",this.ctx.lineWidth=.5;for(let t=0;t<this.width;t+=32)this.ctx.beginPath(),this.ctx.moveTo(t,0),this.ctx.lineTo(t,this.height),this.ctx.stroke();for(let t=0;t<this.height;t+=32)this.ctx.beginPath(),this.ctx.moveTo(0,t),this.ctx.lineTo(this.width,t),this.ctx.stroke();const e=this.calculatePopulationDensity(t.warriors);this.renderDensityOverlay(e)}calculatePopulationDensity(t){const e=Array(8).fill(null).map(()=>Array(8).fill(0));for(const i of t){const t=Math.floor(i.x/64*8),s=Math.floor(i.y/64*8);t>=0&&t<8&&s>=0&&s<8&&(e[s][t]+=i.energy)}return e}renderDensityOverlay(t){const e=t.length,i=this.width/e,s=this.height/e;for(let n=0;n<e;n++)for(let o=0;o<e;o++){const e=t[n][o];if(e>0){const t=Math.min(e/500,.2);this.ctx.fillStyle=`rgba(0, 255, 136, ${t})`,this.ctx.fillRect(o*i,n*s,i,s)}}}}class a{constructor(t){this.width=0,this.height=0,this.imageData=null,this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("Failed to get 2D rendering context for heatmap");this.ctx=e,this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.pointerEvents="none",this.canvas.style.mixBlendMode="multiply",this.setupCanvas()}setupCanvas(){const t=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*t,this.canvas.height=e.height*t,this.ctx.scale(t,t),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.width=e.width,this.height=e.height,this.imageData=this.ctx.createImageData(this.width,this.height)}resize(t,e){this.width=t,this.height=e;const i=window.devicePixelRatio||1;this.canvas.width=t*i,this.canvas.height=e*i,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.scale(i,i),this.imageData=this.ctx.createImageData(t,e)}show(){this.canvas.style.display="block"}hide(){this.canvas.style.display="none"}render(t){if(!this.imageData||!t)return;this.ctx.clearRect(0,0,this.width,this.height);const e=this.width/t.width,i=this.height/t.height;e>=1&&i>=1?this.renderUpscaled(t,e,i):this.renderDownscaled(t,e,i),this.renderLegend()}renderUpscaled(t,e,i){if(!this.imageData)return;const s=this.imageData.data;for(let n=0;n<this.height;n++)for(let o=0;o<this.width;o++){const a=Math.floor(o/e),r=Math.floor(n/i);if(a<t.width&&r<t.height){const e=r*t.width+a,i=t.data[e]||0,h=4*(n*this.width+o),l=this.intensityToColor(i);s[h]=l.r,s[h+1]=l.g,s[h+2]=l.b,s[h+3]=l.a}}this.ctx.putImageData(this.imageData,0,0)}renderDownscaled(t,e,i){if(!this.imageData)return;const s=this.imageData.data;for(let n=0;n<this.height;n++)for(let o=0;o<this.width;o++){const a=Math.floor(o/e),r=Math.floor((o+1)/e),h=Math.floor(n/i),l=Math.floor((n+1)/i);let c=0,d=0;for(let e=h;e<=l&&e<t.height;e++)for(let i=a;i<=r&&i<t.width;i++){const s=e*t.width+i;c+=t.data[s]||0,d++}const m=d>0?c/d:0,g=4*(n*this.width+o),u=this.intensityToColor(m);s[g]=u.r,s[g+1]=u.g,s[g+2]=u.b,s[g+3]=u.a}this.ctx.putImageData(this.imageData,0,0)}intensityToColor(t){const e=Math.max(0,Math.min(1,t));let i,s,n;if(e<.25){const t=4*e;i=Math.floor(255*t),s=0,n=0}else if(e<.5){const t=4*(e-.25);i=255,s=Math.floor(255*t),n=0}else if(e<.75){const t=4*(e-.5);i=255,s=255,n=Math.floor(128*t)}else{const t=4*(e-.75);i=255,s=255,n=128+Math.floor(127*t)}return{r:i,g:s,b:n,a:Math.floor(255*Math.min(1.5*e,.8))}}renderLegend(){const t=20,e=this.width-t-10,i=this.ctx.createLinearGradient(0,110,0,10);i.addColorStop(0,"rgba(0, 0, 0, 0.8)"),i.addColorStop(.25,"rgba(255, 0, 0, 0.8)"),i.addColorStop(.5,"rgba(255, 255, 0, 0.8)"),i.addColorStop(.75,"rgba(255, 255, 128, 0.8)"),i.addColorStop(1,"rgba(255, 255, 255, 0.8)"),this.ctx.fillStyle=i,this.ctx.fillRect(e,10,t,100),this.ctx.strokeStyle="#ffffff66",this.ctx.lineWidth=1,this.ctx.strokeRect(e,10,t,100),this.ctx.fillStyle="#ffffff",this.ctx.font="10px monospace",this.ctx.textAlign="left",this.ctx.fillText("Memory",e+t+5,20),this.ctx.fillText("Usage",e+t+5,32),this.ctx.fillText("High",e+t+5,45),this.ctx.fillText("Med",e+t+5,65),this.ctx.fillText("Low",e+t+5,105)}renderStaticOverlay(){this.ctx.strokeStyle="#ff000033",this.ctx.lineWidth=.5;for(let t=0;t<this.width;t+=32)this.ctx.beginPath(),this.ctx.moveTo(t,0),this.ctx.lineTo(t,this.height),this.ctx.stroke();for(let t=0;t<this.height;t+=32)this.ctx.beginPath(),this.ctx.moveTo(0,t),this.ctx.lineTo(this.width,t),this.ctx.stroke()}}class r{constructor(t){this.width=0,this.height=0,this.animationFrame=0,this.layerSpacing=150,this.nodeSpacing=40,this.maxNodeRadius=15,this.minNodeRadius=5,this.canvas=t;const e=t.getContext("2d");if(!e)throw new Error("Failed to get 2D rendering context for network");this.ctx=e,this.canvas.style.position="absolute",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.pointerEvents="none",this.canvas.style.background="rgba(0, 0, 0, 0.1)",this.setupCanvas()}setupCanvas(){const t=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*t,this.canvas.height=e.height*t,this.ctx.scale(t,t),this.canvas.style.width=e.width+"px",this.canvas.style.height=e.height+"px",this.width=e.width,this.height=e.height}resize(t,e){this.width=t,this.height=e;const i=window.devicePixelRatio||1;this.canvas.width=t*i,this.canvas.height=e*i,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.scale(i,i)}show(){this.canvas.style.display="block"}hide(){this.canvas.style.display="none"}render(t){if(!t||!t.nodes.length)return;this.ctx.clearRect(0,0,this.width,this.height);const e=this.organizeNodesByLayers(t.nodes),i=this.calculateLayout(e);this.renderConnections(t.connections,i),this.renderNodes(i),this.renderInfoPanel(t),this.animateActivations(i)}organizeNodesByLayers(t){const e=new Map;for(const i of t){const t=i.node_type;e.has(t)||e.set(t,[]),e.get(t).push(i)}return e}calculateLayout(t){const e=new Map,i=["input","hidden","output"],s=i.length;return i.forEach((i,n)=>{const o=t.get(i)||[],a=this.width/(s+1)*(n+1);o.forEach((t,i)=>{const s=this.height/(o.length+1)*(i+1);e.set(t.id,{x:a,y:s,node:t})})}),e}renderConnections(t,e){for(const i of t){const t=e.get(i.from),s=e.get(i.to);if(!t||!s)continue;const n=i.weight,o=Math.abs(n),a=Math.min(.8*o+.2,1),r=n>=0?"#00ff88":"#ff4444",h=Math.max(.5,Math.min(4,3*o)),l=this.ctx.createLinearGradient(t.x,t.y,s.x,s.y);if(l.addColorStop(0,r+Math.floor(255*a).toString(16).padStart(2,"0")),l.addColorStop(1,r+"22"),this.ctx.strokeStyle=l,this.ctx.lineWidth=h,this.drawCurvedConnection(t.x,t.y,s.x,s.y),o>.7){const e=(t.x+s.x)/2,i=(t.y+s.y)/2;this.ctx.fillStyle="#ffffff88",this.ctx.font="8px monospace",this.ctx.textAlign="center",this.ctx.fillText(n.toFixed(2),e,i)}}}drawCurvedConnection(t,e,i,s){const n=.3*Math.abs(i-t);this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.bezierCurveTo(t+n,e,i-n,s,i,s),this.ctx.stroke()}renderNodes(t){for(const[e,i]of t){const t=i.node,s=i.x,n=i.y,o=Math.abs(t.activation),a=this.minNodeRadius+(this.maxNodeRadius-this.minNodeRadius)*o;let r;switch(t.node_type){case"input":r="#0088ff";break;case"output":r="#ff8800";break;default:r="#00ff88"}if(o>.3){const t=a+10*o,e=this.ctx.createRadialGradient(s,n,0,s,n,t);e.addColorStop(0,r+"66"),e.addColorStop(1,r+"00"),this.ctx.fillStyle=e,this.ctx.beginPath(),this.ctx.arc(s,n,t,0,2*Math.PI),this.ctx.fill()}this.ctx.fillStyle=r,this.ctx.beginPath(),this.ctx.arc(s,n,a,0,2*Math.PI),this.ctx.fill(),this.ctx.strokeStyle="#ffffff",this.ctx.lineWidth=2,this.ctx.stroke(),o>.1&&(this.ctx.fillStyle="#ffffff",this.ctx.font="10px monospace",this.ctx.textAlign="center",this.ctx.fillText(t.activation.toFixed(2),s,n+3)),this.ctx.fillStyle="#ffffff88",this.ctx.font="8px monospace",this.ctx.textAlign="center",this.ctx.fillText(`#${e}`,s,n+a+12)}}renderInfoPanel(t){this.ctx.fillStyle="rgba(10, 10, 35, 0.9)",this.ctx.fillRect(10,10,200,120),this.ctx.strokeStyle="#00ff88",this.ctx.lineWidth=1,this.ctx.strokeRect(10,10,200,120),this.ctx.fillStyle="#00ff88",this.ctx.font="bold 12px monospace",this.ctx.textAlign="left",this.ctx.fillText("üß† Network Topology",20,30);const e=t.nodes.filter(t=>"input"===t.node_type).length,i=t.nodes.filter(t=>"hidden"===t.node_type).length,s=t.nodes.filter(t=>"output"===t.node_type).length,n=t.connections.length,o=t.nodes.reduce((t,e)=>t+Math.abs(e.activation),0)/t.nodes.length;this.ctx.fillStyle="#ffffff",this.ctx.font="10px monospace",this.ctx.fillText(`Input Nodes: ${e}`,20,50),this.ctx.fillText(`Hidden Nodes: ${i}`,20,65),this.ctx.fillText(`Output Nodes: ${s}`,20,80),this.ctx.fillText(`Connections: ${n}`,20,95),this.ctx.fillText(`Avg Activation: ${o.toFixed(3)}`,20,110)}animateActivations(t){this.animationFrame=(this.animationFrame+1)%60;const e=.5*Math.sin(.2*this.animationFrame)+.5;for(const[i,s]of t){const t=s.node;if(Math.abs(t.activation)>.8){const t=s.x,i=s.y,n=20+10*e;this.ctx.strokeStyle=`rgba(255, 255, 255, ${.3-.2*e})`,this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.arc(t,i,n,0,2*Math.PI),this.ctx.stroke()}}}renderActivationFlow(t,e){const i=.005*Date.now();for(const s of t){const t=e.get(s.from),n=e.get(s.to);if(!t||!n||Math.abs(s.weight)<.3)continue;const o=(Math.sin(i+.1*s.from)+1)/2,a=t.x+(n.x-t.x)*o,r=t.y+(n.y-t.y)*o;this.ctx.fillStyle=s.weight>0?"#00ff88aa":"#ff4444aa",this.ctx.beginPath(),this.ctx.arc(a,r,3,0,2*Math.PI),this.ctx.fill()}}}class h{constructor(){this.startButton=this.getElement("startBtn"),this.pauseButton=this.getElement("pauseBtn"),this.resetButton=this.getElement("resetBtn"),this.stepButton=this.getElement("stepBtn"),this.generationButton=this.getElement("generationBtn"),this.speedSlider=this.getElement("speedSlider"),this.speedValue=this.getElement("speedValue"),this.heatmapButton=this.getElement("heatmapBtn"),this.topologyButton=this.getElement("topologyBtn"),this.territoriesButton=this.getElement("territoriesBtn"),this.resourcesButton=this.getElement("resourcesBtn"),this.exportJsonButton=this.getElement("exportJsonBtn"),this.exportCsvButton=this.getElement("exportCsvBtn"),this.setupEventListeners(),this.initializeUI()}getElement(t){const e=document.getElementById(t);if(!e)throw new Error(`Element with id '${t}' not found`);return e}setupEventListeners(){this.startButton.addEventListener("click",()=>{this.onStartCallback?.(),this.updateButtonStates("running")}),this.pauseButton.addEventListener("click",()=>{this.onPauseCallback?.(),this.updateButtonStates("paused")}),this.resetButton.addEventListener("click",()=>{this.onResetCallback?.(),this.updateButtonStates("reset")}),this.stepButton.addEventListener("click",()=>{this.onStepCallback?.()}),this.generationButton.addEventListener("click",()=>{this.onGenerationCallback?.()}),this.speedSlider.addEventListener("input",()=>{const t=parseFloat(this.speedSlider.value);this.speedValue.textContent=t.toFixed(1)+"x",this.onSpeedChangeCallback?.(t)}),this.heatmapButton.addEventListener("click",()=>{this.onHeatmapToggleCallback?.(),this.toggleButtonState(this.heatmapButton),this.heatmapButton.classList.contains("active")&&this.topologyButton.classList.remove("active")}),this.topologyButton.addEventListener("click",()=>{this.onTopologyToggleCallback?.(),this.toggleButtonState(this.topologyButton),this.topologyButton.classList.contains("active")&&this.heatmapButton.classList.remove("active")}),this.territoriesButton.addEventListener("click",()=>{this.onTerritoriesToggleCallback?.(),this.toggleButtonState(this.territoriesButton)}),this.resourcesButton.addEventListener("click",()=>{this.onResourcesToggleCallback?.(),this.toggleButtonState(this.resourcesButton)}),this.exportJsonButton.addEventListener("click",()=>{this.onExportJsonCallback?.(),this.showExportFeedback(this.exportJsonButton,"JSON")}),this.exportCsvButton.addEventListener("click",()=>{this.onExportCsvCallback?.(),this.showExportFeedback(this.exportCsvButton,"CSV")}),document.addEventListener("keydown",t=>{this.handleKeyboardShortcuts(t)})}initializeUI(){this.updateButtonStates("reset"),this.territoriesButton.classList.add("active"),this.resourcesButton.classList.add("active"),this.addToggleStyles()}addToggleStyles(){const t=document.createElement("style");t.textContent="\n            .control-button.active {\n                background: linear-gradient(45deg, #00cc66, #00ff88) !important;\n                box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);\n            }\n            \n            .control-button.export-feedback {\n                background: linear-gradient(45deg, #cc6600, #ff8800) !important;\n                transform: scale(0.95);\n                transition: all 0.2s ease;\n            }\n            \n            .control-button:disabled {\n                background: linear-gradient(45deg, #666, #888) !important;\n                cursor: not-allowed;\n                opacity: 0.6;\n            }\n        ",document.head.appendChild(t)}updateButtonStates(t){switch(t){case"running":this.startButton.disabled=!0,this.pauseButton.disabled=!1,this.resetButton.disabled=!1,this.stepButton.disabled=!0,this.generationButton.disabled=!0;break;case"paused":this.startButton.disabled=!1,this.pauseButton.disabled=!0,this.resetButton.disabled=!1,this.stepButton.disabled=!1,this.generationButton.disabled=!1;break;case"reset":this.startButton.disabled=!1,this.pauseButton.disabled=!0,this.resetButton.disabled=!0,this.stepButton.disabled=!1,this.generationButton.disabled=!1}}toggleButtonState(t){t.classList.toggle("active")}showExportFeedback(t,e){const i=t.textContent;t.textContent=`Exported ${e}!`,t.classList.add("export-feedback"),setTimeout(()=>{t.textContent=i,t.classList.remove("export-feedback")},1500)}handleKeyboardShortcuts(t){if(!(t.target instanceof HTMLInputElement))switch(t.key.toLowerCase()){case" ":case"enter":t.preventDefault(),this.startButton.disabled?this.pauseButton.disabled||this.pauseButton.click():this.startButton.click();break;case"r":t.preventDefault(),this.resetButton.click();break;case"s":t.preventDefault(),this.stepButton.click();break;case"g":t.preventDefault(),this.generationButton.click();break;case"h":t.preventDefault(),this.heatmapButton.click();break;case"t":t.preventDefault(),this.topologyButton.click();break;case"m":t.preventDefault(),this.territoriesButton.click();break;case"n":t.preventDefault(),this.resourcesButton.click();break;case"j":t.preventDefault(),this.exportJsonButton.click();break;case"c":t.preventDefault(),this.exportCsvButton.click();break;case"arrowup":case"+":t.preventDefault(),this.adjustSpeed(.1);break;case"arrowdown":case"-":t.preventDefault(),this.adjustSpeed(-.1)}}adjustSpeed(t){const e=parseFloat(this.speedSlider.value),i=Math.max(.1,Math.min(5,e+t));this.speedSlider.value=i.toString(),this.speedValue.textContent=i.toFixed(1)+"x",this.onSpeedChangeCallback?.(i)}onStart(t){this.onStartCallback=t}onPause(t){this.onPauseCallback=t}onReset(t){this.onResetCallback=t}onStep(t){this.onStepCallback=t}onGeneration(t){this.onGenerationCallback=t}onSpeedChange(t){this.onSpeedChangeCallback=t}onHeatmapToggle(t){this.onHeatmapToggleCallback=t}onTopologyToggle(t){this.onTopologyToggleCallback=t}onTerritoriesToggle(t){this.onTerritoriesToggleCallback=t}onResourcesToggle(t){this.onResourcesToggleCallback=t}onExportJson(t){this.onExportJsonCallback=t}onExportCsv(t){this.onExportCsvCallback=t}setSimulationState(t){this.updateButtonStates(t?"running":"paused")}updateMetrics(t){const e=document.getElementById("generation"),i=document.getElementById("population"),s=document.getElementById("species"),n=document.getElementById("fps");e&&(e.textContent=t.generation.toString()),i&&(i.textContent=t.population.toString()),s&&(s.textContent=t.species.toString()),n&&(n.textContent=t.fps.toFixed(1))}showNotification(t,e="success"){const i=document.createElement("div");if(i.textContent=t,i.style.cssText=`\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: ${"success"===e?"linear-gradient(45deg, #00cc66, #00ff88)":"warning"===e?"linear-gradient(45deg, #cc6600, #ff8800)":"linear-gradient(45deg, #cc0066, #ff0088)"};\n            color: white;\n            padding: 12px 20px;\n            border-radius: 5px;\n            font-family: monospace;\n            font-size: 12px;\n            z-index: 10000;\n            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n            animation: slideIn 0.3s ease-out;\n        `,!document.querySelector("#notification-styles")){const t=document.createElement("style");t.id="notification-styles",t.textContent="\n                @keyframes slideIn {\n                    from { transform: translateX(100%); opacity: 0; }\n                    to { transform: translateX(0); opacity: 1; }\n                }\n                @keyframes slideOut {\n                    from { transform: translateX(0); opacity: 1; }\n                    to { transform: translateX(100%); opacity: 0; }\n                }\n            ",document.head.appendChild(t)}document.body.appendChild(i),setTimeout(()=>{i.style.animation="slideOut 0.3s ease-in",setTimeout(()=>{document.body.contains(i)&&document.body.removeChild(i)},300)},3e3)}}class l{constructor(){this.frameStartTime=0,this.frameEndTime=0,this.frameTimes=[],this.maxFrameHistory=60,this.lastFPSUpdate=0,this.currentFPS=0,this.frameCount=0,this.memoryBaseline=0,this.peakMemory=0,this.wasmExecutionTimes=[],this.renderTimes=[],this.initializeMemoryBaseline(),this.lastFPSUpdate=performance.now()}initializeMemoryBaseline(){if("memory"in performance){const t=performance.memory;this.memoryBaseline=t.usedJSHeapSize||0}}frameStart(){this.frameStartTime=performance.now()}frameEnd(){this.frameEndTime=performance.now();const t=this.frameEndTime-this.frameStartTime;this.frameTimes.push(t),this.frameTimes.length>this.maxFrameHistory&&this.frameTimes.shift(),this.frameCount++;const e=performance.now();e-this.lastFPSUpdate>=1e3&&(this.currentFPS=1e3*this.frameCount/(e-this.lastFPSUpdate),this.frameCount=0,this.lastFPSUpdate=e,this.updateMemoryStats())}updateMemoryStats(){if("memory"in performance){const t=performance.memory.usedJSHeapSize||0;this.peakMemory=Math.max(this.peakMemory,t)}}measureWasmExecution(t){const e=performance.now(),i=t(),s=performance.now();return this.wasmExecutionTimes.push(s-e),this.wasmExecutionTimes.length>100&&this.wasmExecutionTimes.shift(),i}measureRenderTime(t){const e=performance.now(),i=t(),s=performance.now();return this.renderTimes.push(s-e),this.renderTimes.length>100&&this.renderTimes.shift(),i}getFPS(){return this.currentFPS}getAverageFrameTime(){return 0===this.frameTimes.length?0:this.frameTimes.reduce((t,e)=>t+e,0)/this.frameTimes.length}getMinFrameTime(){return this.frameTimes.length>0?Math.min(...this.frameTimes):0}getMaxFrameTime(){return this.frameTimes.length>0?Math.max(...this.frameTimes):0}getFrameTimeStandardDeviation(){if(this.frameTimes.length<2)return 0;const t=this.getAverageFrameTime(),e=this.frameTimes.reduce((e,i)=>e+Math.pow(i-t,2),0)/this.frameTimes.length;return Math.sqrt(e)}getAverageWasmExecutionTime(){return 0===this.wasmExecutionTimes.length?0:this.wasmExecutionTimes.reduce((t,e)=>t+e,0)/this.wasmExecutionTimes.length}getAverageRenderTime(){return 0===this.renderTimes.length?0:this.renderTimes.reduce((t,e)=>t+e,0)/this.renderTimes.length}getMemoryUsage(){let t=0;return"memory"in performance&&(t=performance.memory.usedJSHeapSize||0),{current:t,peak:this.peakMemory,baseline:this.memoryBaseline,growth:t-this.memoryBaseline}}getPerformanceReport(){const t={average:this.getAverageFrameTime(),min:this.getMinFrameTime(),max:this.getMaxFrameTime(),stdDev:this.getFrameTimeStandardDeviation()},e=this.getMemoryUsage(),i=this.getAverageWasmExecutionTime(),s=this.getAverageRenderTime(),n=this.analyzePerformance(this.currentFPS,t,i,s,e);return{fps:this.currentFPS,frameTime:t,wasmExecution:{average:i,samples:this.wasmExecutionTimes.length},rendering:{average:s,samples:this.renderTimes.length},memory:e,performance:n}}analyzePerformance(t,e,i,s,n){const o=[];let a="none",r="excellent";return t<30?(r="poor",o.push("Frame rate is below 30 FPS - consider reducing simulation complexity")):t<45?(r="fair",o.push("Frame rate is below 45 FPS - some optimizations recommended")):t<55&&(r="good"),e.stdDev>5&&(o.push("Frame times are inconsistent - consider frame rate limiting"),"none"===a&&(a="frame_consistency")),i>8&&(o.push("WebAssembly execution time is high - optimize simulation logic"),a="wasm_execution","poor"!==r&&(r="fair")),s>12&&(o.push("Rendering time is high - consider reducing visual complexity"),"none"===a&&(a="rendering"),"poor"!==r&&(r="fair")),n.growth/1048576>50&&(o.push("Memory usage is growing - possible memory leak detected"),"none"===a&&(a="memory_leak"),"poor"!==r&&(r="fair")),i>2*s?a="simulation_logic":s>2*i&&(a="rendering"),{rating:r,bottleneck:a,suggestions:o}}startProfiling(){this.frameTimes=[],this.wasmExecutionTimes=[],this.renderTimes=[],this.frameCount=0,this.lastFPSUpdate=performance.now(),this.initializeMemoryBaseline(),console.log("üîç Performance profiling started")}stopProfiling(){const t=this.getPerformanceReport();console.log("üìä Performance Profiling Report:"),console.log(`FPS: ${t.fps.toFixed(1)}`),console.log(`Average Frame Time: ${t.frameTime.average.toFixed(2)}ms`),console.log(`WebAssembly Execution: ${t.wasmExecution.average.toFixed(2)}ms`),console.log(`Rendering Time: ${t.rendering.average.toFixed(2)}ms`),console.log(`Memory Growth: ${(t.memory.growth/1048576).toFixed(2)}MB`),console.log(`Performance Rating: ${t.performance.rating.toUpperCase()}`),"none"!==t.performance.bottleneck&&console.log(`Primary Bottleneck: ${t.performance.bottleneck}`),t.performance.suggestions.length>0&&(console.log("Optimization Suggestions:"),t.performance.suggestions.forEach(t=>{console.log(`  ‚Ä¢ ${t}`)}))}logRealTimeStats(){const t=this.getPerformanceReport(),e=[`FPS: ${t.fps.toFixed(1)}`,`Frame: ${t.frameTime.average.toFixed(1)}ms`,`WASM: ${t.wasmExecution.average.toFixed(1)}ms`,`Render: ${t.rendering.average.toFixed(1)}ms`,`Mem: ${(t.memory.current/1048576).toFixed(1)}MB`].join(" | ");console.log(`‚ö° ${e}`)}}class c{constructor(t){this.config=t,this.simulation=null,this.isRunning=!1,this.animationId=null,this.lastFrameTime=0,this.frameCount=0,this.settings={showHeatmap:!1,showTopology:!1,showTerritories:!0,showResources:!0,showTrails:!1,simulationSpeed:1};const e=document.getElementById("mainCanvas"),i=document.getElementById("heatmapCanvas"),s=document.getElementById("networkCanvas");this.mainRenderer=new o(e),this.heatmapRenderer=new a(i),this.networkRenderer=new r(s),this.controlPanel=new h,this.performanceMonitor=new l,this.setupEventListeners()}async initialize(){try{console.log("üîÑ Loading WebAssembly module..."),this.wasmModule=await n.e(31).then(n.bind(n,31)),console.log("‚úÖ WebAssembly module loaded");const t=JSON.stringify(this.config);this.simulation=new this.wasmModule.WasmSimulation(t),this.simulation?.initialize_population(100),console.log("‚úÖ Simulation initialized"),this.setupCanvases(),this.startRenderLoop()}catch(t){throw console.error("Failed to initialize WebAssembly:",t),new Error(`WebAssembly initialization failed: ${t}`)}}setupCanvases(){const t=document.querySelector(".visualization-area"),e=t.clientWidth,i=t.clientHeight;this.mainRenderer.resize(e,i),this.heatmapRenderer.resize(e,i),this.heatmapRenderer.hide(),this.networkRenderer.resize(e,i),this.networkRenderer.hide(),console.log(`üìê Canvases initialized: ${e}x${i}`)}setupEventListeners(){window.addEventListener("resize",()=>{this.setupCanvases()}),this.controlPanel.onStart(()=>this.start()),this.controlPanel.onPause(()=>this.pause()),this.controlPanel.onReset(()=>this.reset()),this.controlPanel.onStep(()=>this.step()),this.controlPanel.onGeneration(()=>this.runGeneration()),this.controlPanel.onSpeedChange(t=>{this.settings.simulationSpeed=t}),this.controlPanel.onHeatmapToggle(()=>this.toggleHeatmap()),this.controlPanel.onTopologyToggle(()=>this.toggleTopology()),this.controlPanel.onTerritoriesToggle(()=>this.toggleTerritories()),this.controlPanel.onResourcesToggle(()=>this.toggleResources()),this.controlPanel.onExportJson(()=>this.exportData("json")),this.controlPanel.onExportCsv(()=>this.exportData("csv"))}startRenderLoop(){const t=e=>{if(this.performanceMonitor.frameStart(),this.isRunning&&this.simulation&&e-this.lastFrameTime>=1e3/(60*this.settings.simulationSpeed)){const t=this.simulation.step();this.updateVisualization(t),this.updateUI(t),this.lastFrameTime=e}if(this.performanceMonitor.frameEnd(),this.frameCount++,this.frameCount%60==0){const t=this.performanceMonitor.getFPS();document.getElementById("fps").textContent=t.toFixed(1)}this.animationId=requestAnimationFrame(t)};this.animationId=requestAnimationFrame(t)}updateVisualization(t){if(t)try{const e=t;if(this.mainRenderer.render(e,this.settings),this.settings.showHeatmap&&this.simulation){const t=this.simulation.get_memory_heatmap();this.heatmapRenderer.render(t)}if(this.settings.showTopology&&this.simulation&&e.warriors.length>0){const t=this.simulation.get_network_topology(e.warriors[0].id);this.networkRenderer.render(t)}}catch(t){console.warn("Visualization update error:",t)}}updateUI(t){if(t)try{const e=t;document.getElementById("generation").textContent=e.generation.toString(),document.getElementById("population").textContent=e.population_size.toString(),document.getElementById("species").textContent=e.species_count.toString(),document.getElementById("avgFitness").textContent=e.average_fitness.toFixed(1),document.getElementById("maxFitness").textContent=e.max_fitness.toFixed(1),document.getElementById("diversity").textContent=e.diversity_score.toFixed(2),document.getElementById("pressure").textContent=e.environmental_pressure.toFixed(2)}catch(t){console.warn("UI update error:",t)}}start(){this.simulation&&(this.simulation.start(),this.isRunning=!0,console.log("‚ñ∂Ô∏è Simulation started"))}pause(){this.simulation&&(this.simulation.pause(),this.isRunning=!1,console.log("‚è∏Ô∏è Simulation paused"))}reset(){this.simulation&&(this.simulation.reset(),this.simulation.initialize_population(100),this.isRunning=!1,console.log("üîÑ Simulation reset"))}step(){if(this.simulation){const t=this.simulation.step();this.updateVisualization(t),this.updateUI(t),console.log("‚è≠Ô∏è Single step executed")}}runGeneration(){if(this.simulation){const t=this.simulation.run_generation();this.updateVisualization(t),this.updateUI(t),console.log("üß¨ Generation completed")}}toggleHeatmap(){this.settings.showHeatmap=!this.settings.showHeatmap,this.settings.showHeatmap?(this.heatmapRenderer.show(),this.settings.showTopology=!1,this.networkRenderer.hide()):this.heatmapRenderer.hide(),console.log("üî• Heatmap:",this.settings.showHeatmap?"ON":"OFF")}toggleTopology(){this.settings.showTopology=!this.settings.showTopology,this.settings.showTopology?(this.networkRenderer.show(),this.settings.showHeatmap=!1,this.heatmapRenderer.hide()):this.networkRenderer.hide(),console.log("üï∏Ô∏è Network topology:",this.settings.showTopology?"ON":"OFF")}toggleTerritories(){this.settings.showTerritories=!this.settings.showTerritories,console.log("üó∫Ô∏è Territories:",this.settings.showTerritories?"ON":"OFF")}toggleResources(){this.settings.showResources=!this.settings.showResources,console.log("üíé Resources:",this.settings.showResources?"ON":"OFF")}exportData(t){if(this.simulation){const e=this.simulation.export_data(t),i=new Blob([e],{type:"json"===t?"application/json":"text/csv"}),s=URL.createObjectURL(i),n=document.createElement("a");n.href=s,n.download=`neural-arena-data.${t}`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s),console.log(`üíæ Data exported as ${t.toUpperCase()}`)}}destroy(){this.animationId&&cancelAnimationFrame(this.animationId),this.isRunning=!1,console.log("üóëÔ∏è Application destroyed")}}!async function(){console.log("üß† Neural Network Arena - WebAssembly Frontend Starting...");try{const t=document.getElementById("loadingScreen"),e=document.getElementById("mainContainer"),i=new c({max_population:200,vm_memory_size:2048,territory_size:64,target_species_count:8,mutation_rate:.05,survival_threshold:.3,fitness_sharing:!0,elitism_rate:.1,tournament_size:3,max_generations:1e3,performance_target_rps:1e3});await i.initialize(),setTimeout(()=>{t.style.display="none",e.style.display="grid",console.log("‚úÖ Neural Network Arena fully loaded!")},2e3)}catch(t){console.error("‚ùå Failed to initialize Neural Network Arena:",t),alert("Failed to load Neural Network Arena. Please check the console for details.")}}()})();